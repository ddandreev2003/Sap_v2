# üéâ –ü–û–õ–ù–û–ï –†–£–ö–û–í–û–î–°–¢–í–û: SAP –î–ï–ö–û–ú–ü–û–ó–ò–¶–ò–Ø –° ZEPHYR –ò GPT

–≠—Ç–æ—Ç —Ñ–∞–π–ª –æ–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã —Å Zephyr SAP –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–µ–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π workflow.

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: –° GPT (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è –∫–∞—á–µ—Å—Ç–≤–∞)
```bash
# 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å API –∫–ª—é—á
export OPENAI_API_KEY="sk-..."

# 2. –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å SAP –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
python workflow_example.py --step 1 --llm GPT

# 3. –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (—Å –ª—é–±—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏)
python workflow_example.py --step 2 --mode sap
python workflow_example.py --step 2 --mode sap --num-seeds 4
python workflow_example.py --step 2 --mode sap --num-steps 50
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –° Zephyr (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –ª–æ–∫–∞–ª—å–Ω–æ)
```bash
# 1. –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å SAP –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
python workflow_example.py --step 1 --llm Zephyr

# 2. –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
python workflow_example.py --step 2 --mode sap
```

### –í–∞—Ä–∏–∞–Ω—Ç 3: –ü—Ä—è–º–æ –±–µ–∑ SAP (–±–µ–∑ LLM)
```bash
# –ë—ã—Å—Ç—Ä–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è –±–µ–∑ –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏
python workflow_example.py --step 2 --mode direct
```

---

## üìã –°–¢–†–£–ö–¢–£–†–ê –°–ò–°–¢–ï–ú–´

```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å / –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  workflow_example.py                    ‚îÇ ‚Üê –ì–ª–∞–≤–Ω—ã–π —Å–∫—Ä–∏–ø—Ç
‚îÇ  (—É–ø—Ä–∞–≤–ª—è–µ—Ç –≤—Å–µ–º –ø—Ä–æ—Ü–µ—Å—Å–æ–º)            ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ              ‚Üì                          ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ   –®–∞–≥ 1        ‚îÇ      –®–∞–≥ 2             ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ generate_sap   ‚îÇ  combined_flux_sap.py  ‚îÇ
‚îÇ _prompts.py    ‚îÇ                        ‚îÇ
‚îÇ       ‚Üì        ‚îÇ        ‚Üì               ‚îÇ
‚îÇ llm_SAP.py     ‚îÇ SAP_pipeline_flux.py   ‚îÇ
‚îÇ  (Zephyr –∏–ª–∏   ‚îÇ (FLUX –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ)   ‚îÇ
‚îÇ    GPT)        ‚îÇ                        ‚îÇ
‚îÇ       ‚Üì        ‚îÇ                        ‚îÇ
‚îÇ SAP_prompts    ‚îÇ images/               ‚îÇ
‚îÇ .json          ‚îÇ                        ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

---

## üîç –î–ò–ê–ì–ù–û–°–¢–ò–ö–ê

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç
```bash
python test_system.py
```

–î–æ–ª–∂–Ω–æ –ø—Ä–æ–π—Ç–∏ 8/8 —Ç–µ—Å—Ç–æ–≤ (–∏–ª–∏ 6/8 –µ—Å–ª–∏ PyTorch –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω - —ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ).

### –ü—Ä–æ–≤–µ—Ä–∏—Ç—å Zephyr —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ
```bash
python test_zephyr_sap.py
```

–î–æ–ª–∂–µ–Ω –≤—ã–≤–µ—Å—Ç–∏:
```
üéâ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´! Zephyr —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.
```

---

## üêõ –ß–ê–°–¢–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò –†–ï–®–ï–ù–ò–Ø

### –ü—Ä–æ–±–ª–µ–º–∞ 1: "Parsing failed: Could not find dictionary pattern"

**–ü—Ä–∏—á–∏–Ω–∞:** Zephyr –Ω–µ –≤—ã–¥–∞—ë—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ—Ç–≤–µ—Ç

**–†–µ—à–µ–Ω–∏–µ 1 (—É–∂–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–æ):** 
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ –æ–¥–Ω–æ–º—É –ø—Ä–æ–º—Ç—É –≤–º–µ—Å—Ç–æ –±–∞—Ç—á–∞ ‚úÖ
- –£–≤–µ–ª–∏—á–µ–Ω–æ `max_new_tokens` —Å 256 –¥–æ 512 ‚úÖ
- –£–º–µ–Ω—å—à–µ–Ω–∞ `temperature` —Å 0.7 –¥–æ 0.5 ‚úÖ

**–†–µ—à–µ–Ω–∏–µ 2 (–µ—Å–ª–∏ –≤—Å—ë –µ—â—ë –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç):**
```bash
# –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ GPT
export OPENAI_API_KEY="sk-..."
python workflow_example.py --step 1 --llm GPT
```

### –ü—Ä–æ–±–ª–µ–º–∞ 2: "CUDA out of memory"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –£–º–µ–Ω—å—à–∏—Ç—å —Ä–∞–∑–º–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
python workflow_example.py --step 2 --mode sap \
  --height 768 --width 768

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å CPU offload
python workflow_example.py --step 2 --mode sap --enable-cpu-offload
```

### –ü—Ä–æ–±–ª–µ–º–∞ 3: "Module not found: torch"

**–†–µ—à–µ–Ω–∏–µ:**
```bash
pip install -r requirements.txt
```

### –ü—Ä–æ–±–ª–µ–º–∞ 4: API –∫–ª—é—á –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —á—Ç–æ –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞
echo $OPENAI_API_KEY

# –ï—Å–ª–∏ –ø—É—Å—Ç–æ, —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
export OPENAI_API_KEY="sk-..."

# –ò–ª–∏ –¥–æ–±–∞–≤–∏—Ç—å –≤ ~/.bashrc (–ø–æ—Å—Ç–æ—è–Ω–Ω–æ)
echo 'export OPENAI_API_KEY="sk-..."' >> ~/.bashrc
source ~/.bashrc
```

---

## üìä –°–†–ê–í–ù–ï–ù–ò–ï –ü–û–î–•–û–î–û–í

### –ü—Ä—è–º–∞—è –≥–µ–Ω–µ—Ä–∞—Ü–∏—è (Direct FLUX)
```
–ü—Ä–æ–º—Ç—ã ‚Üí FLUX ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
```
- ‚ö° **–ë—ã—Å—Ç—Ä–æ:** 5-10 –º–∏–Ω—É—Ç –¥–ª—è 10 –ø—Ä–æ–º—Ç–æ–≤
- üí∞ **–î—ë—à–µ–≤–æ:** –ë–µ—Å–ø–ª–∞—Ç–Ω–æ (–Ω–µ—Ç API –≤—ã–∑–æ–≤–æ–≤)
- ‚≠ê **–ö–∞—á–µ—Å—Ç–≤–æ:** –•–æ—Ä–æ—à–µ–µ (–±–∞–∑–æ–≤–æ–µ)
- üéØ **–õ—É—á—à–µ –¥–ª—è:** –ü—Ä–æ—Ç–æ—Ç–∏–ø–∏—Ä–æ–≤–∞–Ω–∏—è, –±—ã—Å—Ç—Ä–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### SAP –±–µ–∑ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è (SAP FLUX online)
```
–ü—Ä–æ–º—Ç—ã ‚Üí LLM ‚Üí SAP ‚Üí FLUX ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
       (–∫–∞–∂–¥—ã–π —Ä–∞–∑)
```
- ‚ö° **–ú–µ–¥–ª–µ–Ω–Ω–æ:** 15-30 –º–∏–Ω—É—Ç –¥–ª—è 10 –ø—Ä–æ–º—Ç–æ–≤
- üí∞ **–î–æ—Ä–æ–≥–æ:** ~$0.20 –∑–∞ 10 –ø—Ä–æ–º—Ç–æ–≤ (GPT)
- ‚≠ê **–ö–∞—á–µ—Å—Ç–≤–æ:** –û—Ç–ª–∏—á–Ω–æ–µ (–ª—É—á—à–µ —á–µ–º Direct)
- üéØ **–õ—É—á—à–µ –¥–ª—è:** –†–∞–∑–æ–≤–æ–π –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏, –∫–æ–≥–¥–∞ –∫–∞—á–µ—Å—Ç–≤–æ –≤–∞–∂–Ω–µ–µ —Å–∫–æ—Ä–æ—Å—Ç–∏

### SAP —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```
–ü—Ä–æ–º—Ç—ã ‚Üí LLM ‚Üí SAP ‚Üí JSON (–æ–¥–∏–Ω —Ä–∞–∑)
               ‚Üì
            FLUX ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
            FLUX ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–æ–≤—Ç–æ—Ä–Ω–æ)
            FLUX ‚Üí –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è (–ø–æ–≤—Ç–æ—Ä–Ω–æ)
```
- ‚ö° **–ë—ã—Å—Ç—Ä–æ:** 10 –º–∏–Ω—É—Ç –Ω–∞ –≥–µ–Ω–µ—Ä–∞—Ü–∏—é SAP + 5 –º–∏–Ω—É—Ç –Ω–∞ FLUX
- üí∞ **–î—ë—à–µ–≤–æ:** $0.20 –æ–¥–∏–Ω —Ä–∞–∑, –ø–æ—Ç–æ–º –±–µ—Å–ø–ª–∞—Ç–Ω–æ
- ‚≠ê **–ö–∞—á–µ—Å—Ç–≤–æ:** –û—Ç–ª–∏—á–Ω–æ–µ
- üéØ **–õ—É—á—à–µ –¥–ª—è:** –ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞, –∏—Ç–µ—Ä–∞—Ç–∏–≤–Ω–æ–π —Ä–∞–±–æ—Ç—ã, —Å—Ä–∞–≤–Ω–µ–Ω–∏–π

---

## üöÄ –ü–†–ê–ö–¢–ò–ß–ï–°–ö–ò–ï –ü–†–ò–ú–ï–†–´

### –ü—Ä–∏–º–µ—Ä 1: –ì–µ–Ω–µ—Ä–∞—Ü–∏—è 10 –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–º—Ç–∞

```bash
# 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º SAP (–æ–¥–∏–Ω —Ä–∞–∑)
python workflow_example.py --step 1 --llm GPT --sap-output sap_single.json

# 2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 10 —Ä–∞–∑–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –æ–¥–Ω–æ–≥–æ –ø—Ä–æ–º—Ç–∞
python workflow_example.py --step 2 --sap-output sap_single.json \
  --num-seeds 10 --num-steps 50

# –†–µ–∑—É–ª—å—Ç–∞—Ç: 10 —Ä–∞–∑–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, –Ω–æ –æ–¥–∏–Ω–∞–∫–æ–≤–∞—è SAP –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è
```

### –ü—Ä–∏–º–µ—Ä 2: –°—Ä–∞–≤–Ω–µ–Ω–∏–µ Direct vs SAP

```bash
# 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º SAP
python workflow_example.py --step 1 --llm GPT

# 2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º Direct FLUX
python workflow_example.py --step 2 --mode direct

# 3. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º SAP FLUX
python workflow_example.py --step 2 --mode sap --sap-output SAP_prompts.json

# 4. –°—Ä–∞–≤–Ω–∏–≤–∞–µ–º
python compare_results.py --batch-dir results_combined/batch_*/batch_* --all
```

### –ü—Ä–∏–º–µ—Ä 3: –õ–æ–∫–∞–ª—å–Ω–æ–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–µ –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ

```bash
# 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º SAP –ª–æ–∫–∞–ª—å–Ω–æ (–±–µ—Å–ø–ª–∞—Ç–Ω–æ, –º–µ–¥–ª–µ–Ω–Ω–æ)
python workflow_example.py --step 1 --llm Zephyr

# 2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Ä–∞–∑–Ω—ã–µ –≤–µ—Ä—Å–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
for i in {1..5}; do
  python workflow_example.py --step 2 --sap-output SAP_prompts.json
done

# –†–µ–∑—É–ª—å—Ç–∞—Ç: 50+ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å –∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω–æ–π SAP –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–µ–π, –±–µ—Å–ø–ª–∞—Ç–Ω–æ
```

### –ü—Ä–∏–º–µ—Ä 4: –ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```bash
# 1. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º SAP —Å –¥–æ—Ä–æ–≥–æ–π –º–æ–¥–µ–ª—å—é (–æ–¥–∏–Ω —Ä–∞–∑)
export OPENAI_API_KEY="sk-..."
python workflow_example.py --step 1 --llm GPT --sap-output sap_production.json

# 2. –ò—Å–ø–æ–ª—å–∑—É–µ–º –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–∞ –ø—Ä–æ–µ–∫—Ç–æ–≤
# –ü—Ä–æ–µ–∫—Ç 1: –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
python workflow_example.py --step 2 --sap-output sap_production.json \
  --height 1024 --width 1024 --num-steps 80

# –ü—Ä–æ–µ–∫—Ç 2: –°—Ç–∏–ª—å
python workflow_example.py --step 2 --sap-output sap_production.json \
  --height 768 --width 768 --num-seeds 4

# –ü—Ä–æ–µ–∫—Ç 3: –ß–µ—Ä–Ω–æ–≤–∏–∫
python workflow_example.py --step 2 --sap-output sap_production.json \
  --height 512 --width 512 --num-steps 20

# –†–µ–∑—É–ª—å—Ç–∞—Ç: –æ–¥–∏–Ω —Ä–∞–∑ –∑–∞–ø–ª–∞—Ç–∏–ª–∏, –∏—Å–ø–æ–ª—å–∑—É–µ–º –º–Ω–æ–≥–æ —Ä–∞–∑
```

---

## üìà –û–ü–¢–ò–ú–ò–ó–ê–¶–ò–Ø

### –î–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏
```bash
python workflow_example.py --step 2 --mode direct \
  --height 512 --width 512 --num-steps 20
```
**–í—Ä–µ–º—è:** 3-5 –º–∏–Ω—É—Ç, **–ö–∞—á–µ—Å—Ç–≤–æ:** ‚≠ê‚≠ê

### –î–ª—è –∫–∞—á–µ—Å—Ç–≤–∞
```bash
python workflow_example.py --step 2 --mode sap \
  --sap-output SAP_prompts.json \
  --height 1024 --width 1024 --num-steps 80
```
**–í—Ä–µ–º—è:** 10-15 –º–∏–Ω—É—Ç, **–ö–∞—á–µ—Å—Ç–≤–æ:** ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê

### –î–ª—è –±–∞–ª–∞–Ω—Å–∞ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
```bash
python workflow_example.py --step 2 --mode sap \
  --sap-output SAP_prompts.json \
  --height 1024 --width 1024 --num-steps 50
```
**–í—Ä–µ–º—è:** 8-12 –º–∏–Ω—É—Ç, **–ö–∞—á–µ—Å—Ç–≤–æ:** ‚≠ê‚≠ê‚≠ê‚≠ê

### –î–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –ø–∞–º—è—Ç–∏
```bash
python workflow_example.py --step 2 --mode sap \
  --sap-output SAP_prompts.json \
  --enable-cpu-offload \
  --height 768 --width 768 --num-seeds 1
```

---

## üõ†Ô∏è –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ LLM –≤—ã–∑–æ–≤–æ–≤

**–î–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```
Input:  "–ü—Ä–æ–º—Ç 1", "–ü—Ä–æ–º—Ç 2", "–ü—Ä–æ–º—Ç 3"
LLM:    [–æ–¥–∏–Ω –≤—ã–∑–æ–≤ —Å–æ –≤—Å–µ–º–∏ –ø—Ä–æ–º—Ç–∞–º–∏]
Output: —Ç–æ–ª—å–∫–æ "–ü—Ä–æ–º—Ç 1" (–Ω–µ–ø–æ–ª–Ω—ã–π)
Result: ‚ùå Parsing error
```

**–ü–û–°–õ–ï (–ø—Ä–∞–≤–∏–ª—å–Ω–æ):**
```
Input:  "–ü—Ä–æ–º—Ç 1"
LLM:    [–≤—ã–∑–æ–≤ 1]
Output: –ü–æ–ª–Ω–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è

Input:  "–ü—Ä–æ–º—Ç 2"
LLM:    [–≤—ã–∑–æ–≤ 2]
Output: –ü–æ–ª–Ω–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è

Input:  "–ü—Ä–æ–º—Ç 3"
LLM:    [–≤—ã–∑–æ–≤ 3]
Output: –ü–æ–ª–Ω–∞—è –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è

Result: ‚úÖ –í—Å–µ —É—Å–ø–µ—à–Ω–æ
```

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã Zephyr (–≤ `llm_SAP.py`)

```python
# load_Zephyr_pipeline()
max_new_tokens=512        # –†–∞–∑–º–µ—Ä –æ—Ç–≤–µ—Ç–∞
temperature=0.5           # –¢–≤–æ—Ä—á–µ—Å—Ç–≤–æ (0.3=–¥–µ—Ç–µ—Ä–º–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ, 0.7=—Ç–≤–æ—Ä—á–µ—Å–∫–∏)
do_sample=True            # –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sampling (–ª—É—á—à–µ –∫–∞—á–µ—Å—Ç–≤–æ)
top_p=0.95                # Nucleus sampling

# LLM_SAP_batch_Zephyr()
max_new_tokens=512        # –£–≤–µ–ª–∏—á–µ–Ω–æ —Å 256
temperature=0.5           # –£–º–µ–Ω—å—à–µ–Ω–æ —Å 0.7
```

---

## ‚úÖ –ß–ï–ö–õ–ò–°–¢ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

- [ ] –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip install -r requirements.txt`
- [ ] –°–æ–∑–¥–∞–Ω —Ñ–∞–π–ª `prompts.txt` —Å –ø—Ä–æ–º—Ç–∞–º–∏ (–æ–¥–∏–Ω –Ω–∞ —Å—Ç—Ä–æ–∫—É)
- [ ] –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è GPT: —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω `OPENAI_API_KEY`
- [ ] –ó–∞–ø—É—â–µ–Ω —Ç–µ—Å—Ç: `python test_system.py` ‚Üí 8/8 —Ç–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ
- [ ] –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ SAP: `python test_zephyr_sap.py` (–µ—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Zephyr)
- [ ] –ó–∞–ø—É—â–µ–Ω workflow: `python workflow_example.py --step 1 --llm [GPT|Zephyr]`
- [ ] –°–æ–∑–¥–∞–Ω—ã –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: `python workflow_example.py --step 2`
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤: `results_combined/batch_*/`

---

## üìö –î–û–ü–û–õ–ù–ò–¢–ï–õ–¨–ù–ê–Ø –ò–ù–§–û–†–ú–ê–¶–ò–Ø

- [QUICKSTART.md](QUICKSTART.md) - –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç
- [PREGENERATION_WORKFLOW.md](PREGENERATION_WORKFLOW.md) - –ü–æ–¥—Ä–æ–±–Ω—ã–π workflow
- [ZEPHYR_PROBLEM_SOLVED.md](ZEPHYR_PROBLEM_SOLVED.md) - –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π
- [README.md](README.md) - –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã

---

## üÜò –ü–û–õ–£–ß–ò–¢–¨ –ü–û–ú–û–©–¨

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å [ZEPHYR_PROBLEM_SOLVED.md](ZEPHYR_PROBLEM_SOLVED.md) - —Ç–∞–º –æ–ø–∏—Å–∞–Ω—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è
2. –ó–∞–ø—É—Å—Ç–∏—Ç—å `python test_zephyr_sap.py` - –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞
3. –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
4. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ GPT –µ—Å–ª–∏ Zephyr –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç
5. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –æ—à–∏–±–∫—É –ø–æ–ª–Ω–æ—Å—Ç—å—é - —á–∞—Å—Ç–æ —Ç–∞–º –æ–ø–∏—Å–∞–Ω–æ —Ä–µ—à–µ–Ω–∏–µ

---

## üéØ –†–ï–ö–û–ú–ï–ù–î–£–ï–ú–´–ô WORKFLOW

```bash
# 1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ (–æ–¥–Ω–æ—Ä–∞–∑–æ–≤–æ)
pip install -r requirements.txt
export OPENAI_API_KEY="sk-..."  # –ï—Å–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è GPT

# 2. –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ SAP (–æ–¥–∏–Ω —Ä–∞–∑)
python workflow_example.py --step 1 --llm GPT

# 3. –ì–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (–º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ)
python workflow_example.py --step 2 --mode sap --sap-output SAP_prompts.json
python workflow_example.py --step 2 --mode sap --sap-output SAP_prompts.json --num-seeds 4
python workflow_example.py --step 2 --mode sap --sap-output SAP_prompts.json --num-steps 80

# 4. –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
python compare_results.py --batch-dir results_combined/batch_*/batch_* --all
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ú–Ω–æ–∂–µ—Å—Ç–≤–æ –≤—ã—Å–æ–∫–æ–∫–∞—á–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π —Å —Ö–æ—Ä–æ—à–µ–π –¥–µ—Ç–∞–ª–∏–∑–∞—Ü–∏–µ–π, —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º SAP –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏–∏.

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** January 30, 2026  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ Zephyr SAP –ø—Ä–æ–±–ª–µ–º—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã, —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
